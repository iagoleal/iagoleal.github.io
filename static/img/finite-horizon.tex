\documentclass{standalone}

\def\pgfsysdriver{pgfsys-dvisvgm.def}
\usepackage{tikz,pgffor,ifthen}

\usetikzlibrary{animations,positioning, arrows, arrows.meta, backgrounds, fit}

\begin{document}

\colorlet{smoothgray}{gray!80}

\begin{tikzpicture}[
  node distance = 3cm,
  state/.style    = { circle, minimum width = 0.7cm, fill = gray!20, draw = gray!40, very thick },
  terminal/.style = {rectangle, fill = black, scale = 1},
  action/.style   = {
    opacity = 0.8,
    thin,
    smoothgray,
    ->,
    >={Kite[length=4pt,width=2.5pt,inset=1.5pt]},
  },
  animate/glow/.style n args ={3}{
    myself:opacity = {base = "#1", 0s="current value", 0.3s="#2", freeze, begin on={mouse over, of next = #3}},
    myself:opacity = {id = 2, 0s="current value", 0.3s="#1", freeze, begin on= {mouse out, of next = #3} },
  },
]

  % Useful constants
  \def\nStages{4}
  \def\nStates{3}
  \pgfmathsetseed{5671243}

  \node [terminal] (T) at (3*\nStages-1.5, 1.5) {} edge [in = 340, out=20, loop, action] ();

  \foreach \t in {\nStages,...,1} {
    \foreach \s in {\nStates,...,1} {
      % Grid of states
      \node [state, outer sep = 2] (q\t\s) at (3*\t-3, 1.5*\s-1.5) {};

      % Arraws going out of each state
      \ifthenelse{\t < \nStages}{
        \pgfmathtruncatemacro{\next}{\t + 1}

        \foreach \ny in {1,...,\nStates}
          \draw [action] (q\t\s) -- (q\next\ny);
      }
      { \draw [action] (q\t\s) -- (T); }
    }

    \begin{scope}[on background layer]
      \node (bg\t) [animate={glow={0.2}{0.4}{b\t}},
                   inner sep = 0.35cm, rectangle, rounded corners,
                    fill=orange,
                    fit=(q\t1) (q\t\nStates), label=above:{$t = \t$}] {};
    \end{scope}
    \node (b\t) [ inner sep = 0.35cm, rectangle, rounded corners, fill = blue, opacity = 0.0,
                  fit=(q\t1) (q\t\nStates)] at (bg\t) {};
  }
\end{tikzpicture}

\end{document}

